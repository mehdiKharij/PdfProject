<!DOCTYPE html>
<html>
<head>
    <title id="titre">Formulaire RIB</title>
</head>
<body>
<form id="ribForm" action="#" method="post" onsubmit="submitForm(event)">
    <label for="nomClient">Nom client:</label>
    <input type="text" id="nomClient" name="Nom Client" required><br>

    <label for="agence">Agence:</label>
    <input type="text" id="agence" name="Agence" required><br>

    <label for="numCompte">Numero Compte:</label>
    <input type="number" id="numCompte" name="Numero Compte" required><br>

    <label for="ville">Ville:</label>
    <input type="text" id="ville" name="Ville" required><br>

    <button type="submit">Générer le RIB</button>
</form>

<script>
    function submitForm(event) {
        event.preventDefault();
        const formData = new FormData(document.getElementById('ribForm'));

        // Extraire le titre de la balise <title>
        const title = document.querySelector('title').innerText;

        // Ajouter le titre au FormData
        formData.append('title', title);

        fetch('/api/pdf/generate', {
            method: 'POST',
            body: formData
        })
            .then(response => response.blob())
            .then(blob => {
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'rib.pdf';
                a.click();
                window.URL.revokeObjectURL(url);
            })
            .catch(error => console.error('Erreur:', error));
    }
</script>
</body>
</html>
