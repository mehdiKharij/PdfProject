<!DOCTYPE html>
<html>
<head>
    <title id="titre">Formulaire Bulletin</title>
</head>
<body>
<form id="bulletinForm" action="#" method="post" onsubmit="submitForm(event)">
    <label for="studentName">Nom de l'élève:</label>
    <input type="text" id="studentName" name="Student Name" required><br>

    <label for="subject">Matière:</label>
    <input type="text" id="subject" name="Subject" required><br>

    <label for="grade">Note:</label>
    <input type="number" id="grade" name="Grade" required><br>

    <label for="date">Date:</label>
    <input type="date" id="date" name="Date" required><br>

    <button type="submit">Générer Bulletin PDF</button>
</form>

<script>
    function submitForm(event) {
        event.preventDefault();

        // Créez un objet FormData à partir du formulaire
        const form = document.getElementById('bulletinForm');
        const formData = new FormData(form);

        // Extraire le titre de la balise <title>
        const title = document.querySelector('title').innerText;

        // Ajouter le titre au FormData
        formData.append('title', title);

        // Envoyer les données du formulaire avec le titre
        fetch('/api/pdf/generate', {
            method: 'POST',
            body: formData
        })
            .then(response => response.blob())
            .then(blob => {
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'bulletin.pdf';
                a.click();
                window.URL.revokeObjectURL(url);
            })
            .catch(error => console.error('Erreur:', error));
    }
</script>
</body>
</html>
